### Global Variables
@baseUrl = http://localhost:3000
@api = {{baseUrl}}/api
@contentType = application/json

# -----------------------------------------------------------------------------
# HEALTH CHECK
# -----------------------------------------------------------------------------

### Health Check (Root)
GET {{baseUrl}}/
Accept: {{contentType}}

# -----------------------------------------------------------------------------
# AUTHENTICATION
# -----------------------------------------------------------------------------

### 1. Register a New User (Standard)
# Creates a user with role 'USER'
POST {{api}}/auth/register
Content-Type: {{contentType}}

{
  "email": "pahiy49068@dubokutv.com",
  "password": "SecurePassword123!",
  "name": "Jane Doe",
  "promotionalEmails": true,
  "initialRole": "USER"
}

### 2. Register a New Expert
# Creates a user and an empty ExpertProfile
POST {{api}}/auth/register
Content-Type: {{contentType}}

{
  "email": "expert.john@example.com",
  "password": "ExpertPassword123!",
  "name": "John The Expert",
  "promotionalEmails": false,
  "initialRole": "EXPERT"
}

### 3. Login
# On success, this will set 'accessToken' and 'refreshToken' httpOnly cookies.
# The REST Client extension usually manages cookies automatically for subsequent requests.
POST {{api}}/auth/login
Content-Type: {{contentType}}

{
  "email": "pahiy49068@dubokutv.com",
  "password": "SecurePassword123!"
}

### 4. Logout
# Clears the cookies and removes the refresh session from the DB.
POST {{api}}/auth/logout
Content-Type: {{contentType}}

### 5. Refresh Token
# Uses the 'refreshToken' cookie to get a new 'accessToken'.
# (Requires a previous successful Login)
POST {{api}}/auth/refresh
Content-Type: {{contentType}}

### 6. Verify Email
# Replace {{token}} with the token logged in the console or sent via email.
@verificationToken = 50d110af1e4c07c0cbf0dcdd7e8907c87e3ef284356d44e679d7c4b4d73e1155
POST {{api}}/auth/verify-email
Content-Type: {{contentType}}

{
  "token": "{{verificationToken}}"
}

### 7. Resend Verification Email
POST {{api}}/auth/resend-verification
Content-Type: {{contentType}}

{
  "email": "jane.doe@example.com"
}

### 8. Google Login (Swap ID Token)
# Requires a valid Google ID Token obtained from a frontend client.
POST {{api}}/auth/google
Content-Type: {{contentType}}

{
  "idToken": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ij..."
}

### 9. Delete Account (Soft Delete)
# Requires Authentication (Cookie or Bearer).
DELETE {{api}}/auth/me
Content-Type: {{contentType}}

# -----------------------------------------------------------------------------
# EXPERTS
# -----------------------------------------------------------------------------

### 1. Search Experts (Geo-Spatial)
# Finds experts within radiusKm of lat/lng.
# Example Coords: New York City (40.7128, -74.0060)
GET {{api}}/experts/search?lat=40.7128&lng=-74.0060&radiusKm=50
Accept: {{contentType}}

### 2. Get Expert Profile by ID
@expertId = <REPLACE_WITH_UUID_FROM_SEARCH_RESULTS>
GET {{api}}/experts/{{expertId}}
Accept: {{contentType}}

### 3. Update Expert Profile
# Requires Authentication (User must own the profile).
PUT {{api}}/experts/{{expertId}}
Content-Type: {{contentType}}

{
  "headline": "Senior Digital Consultant",
  "bio": "Over 10 years of experience in digital transformation..."
}

# -----------------------------------------------------------------------------
# SERVICES
# -----------------------------------------------------------------------------

### 1. Get All Services
# Returns a list of active services (Cached).
GET {{api}}/services
Accept: {{contentType}}